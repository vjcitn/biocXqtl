[{"path":"https://github.com/vjcitn/biocXqtl/articles/biocXqtl.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"biocXqtl: flexible molecular QTL assessment","text":"eQTL analysis generally involves large data volumes genotype calls. standard representation genotypes emerged, though VCFs plink2 files frequently encountered. package provide flexible approach estimating associations genotype molecular phenotypes gene expression DNA methylation. use RangedSummarizedExperiment structure primary element structuring inputs association test procedures.","code":""},{"path":"https://github.com/vjcitn/biocXqtl/articles/biocXqtl.html","id":"preliminary-illustration","dir":"Articles","previous_headings":"","what":"Preliminary illustration","title":"biocXqtl: flexible molecular QTL assessment","text":"geuv19 RangedSummarizedExperiment derived GeuvadisTranscriptExpr package. assay component provides transcript level counts. Genotypes available colData. computational viewpoint, simplest assessment molecular QTLs involves fitting linear model assess additive association minor allele dose molecular response. organizational viewpoint, simple approach start end RangedSummarizedExperiment instance. bind_Zs carries situation genotype calls managed natural way colData. Z-scores tests association rowRanges limg. first 6 elements mcols rowRanges related annotation. heatmap Z-scores shows band transcripts zero counts. light tiles correspond negative Z-scores, dark tiles positive.  helper functions, basic data layout can seen, illustrating inappropriateness standard linear modeling assumptions underlying interpretation Z-score.","code":"library(biocXqtl) data(geuv19) geuv19 ## class: RangedSummarizedExperiment  ## dim: 4278 91  ## metadata(1): snplocs ## assays(1): counts ## rownames(4278): ENST00000545779 ENST00000408051 ... ENST00000313038 ##   ENST00000401283 ## rowData names(6): tx_id tx_biotype ... gene_id tx_name ## colnames(91): NA06984 NA06985 ... NA12889 NA12890 ## colData names(1330): snp_19_1392636 snp_19_1393723 ... snp_19_58273441 ##   snp_19_58274425 assay(geuv19[1:3,1:4]) ##                    NA06984 NA06985 NA06986 NA06989 ## ENST00000545779 180.000000      40      58     172 ## ENST00000408051   0.000000       0       0       0 ## ENST00000318050   0.805323       0       0       0 rowRanges(geuv19[1:3,]) ## GRanges object with 3 ranges and 6 metadata columns: ##                   seqnames            ranges strand |           tx_id ##                      <Rle>         <IRanges>  <Rle> |     <character> ##   ENST00000545779       18 15254418-15271744      + | ENST00000545779 ##   ENST00000408051       19       71973-72110      + | ENST00000408051 ##   ENST00000318050       19     110643-111696      + | ENST00000318050 ##                               tx_biotype tx_cds_seq_start tx_cds_seq_end ##                              <character>        <integer>      <integer> ##   ENST00000545779 unprocessed_pseudogene             <NA>           <NA> ##   ENST00000408051                  miRNA             <NA>           <NA> ##   ENST00000318050         protein_coding           110679         111596 ##                           gene_id         tx_name ##                       <character>     <character> ##   ENST00000545779 ENSG00000266818 ENST00000545779 ##   ENST00000408051 ENSG00000275604 ENST00000408051 ##   ENST00000318050 ENSG00000176695 ENST00000318050 ##   ------- ##   seqinfo: 319 sequences (1 circular) from GRCh38 genome colData(geuv19)[1:3,1:4] ## DataFrame with 3 rows and 4 columns ##         snp_19_1392636 snp_19_1393723 snp_19_1394530 snp_19_1396952 ##              <integer>      <integer>      <integer>      <integer> ## NA06984              1              0              0              0 ## NA06985              0              0              0              0 ## NA06986              0              0              0              0 m = maf(colData(geuv19)) ok = which(m > .3) limg = geuv19[1:100,] colData(limg) = colData(limg)[,ok] limg = bind_Zs(limg,     colselector=function(se) colnames(colData(se))) limg ## class: RangedSummarizedExperiment  ## dim: 100 91  ## metadata(1): snplocs ## assays(1): counts ## rownames(100): ENST00000545779 ENST00000408051 ... ENST00000313093 ##   ENST00000543365 ## rowData names(243): tx_id tx_biotype ... snp_19_58269173 ##   snp_19_58274425 ## colnames(91): NA06984 NA06985 ... NA12889 NA12890 ## colData names(237): snp_19_1400679 snp_19_1400766 ... snp_19_58269173 ##   snp_19_58274425 zs = data.matrix(as.data.frame(mcols(rowRanges(limg))[,-c(1:6)])) zs[is.na(zs)] = 0 heatmap(zs, Colv=NA, scale=\"none\") mo = function(x) as.numeric(assay(limg[x,])) sn = function(x) as.numeric(colData(limg)[,x]) beeswarm::beeswarm(jitter(mo(\"ENST00000529442\"))~sn(\"snp_19_19631444\"))"},{"path":"https://github.com/vjcitn/biocXqtl/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Vince Carey. Author, maintainer.","code":""},{"path":"https://github.com/vjcitn/biocXqtl/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Carey V (2025). biocXqtl: modular system creating molecular QTL statistics. R package version 0.0.2, https://github.com/vjcitn/biocXqtl.","code":"@Manual{,   title = {biocXqtl: modular system for creating molecular QTL statistics},   author = {Vince Carey},   year = {2025},   note = {R package version 0.0.2},   url = {https://github.com/vjcitn/biocXqtl}, }"},{"path":"https://github.com/vjcitn/biocXqtl/index.html","id":"biocxqtl","dir":"","previous_headings":"","what":"modular system for creating molecular QTL statistics","title":"modular system for creating molecular QTL statistics","text":"molecular QTLs bioconductor infrastructure","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/bind_Zs.html","id":null,"dir":"Reference","previous_headings":"","what":"bind a matrix of Z statistics created with getzs to the rowRanges of a SummarizedExperiment — bind_Zs","title":"bind a matrix of Z statistics created with getzs to the rowRanges of a SummarizedExperiment — bind_Zs","text":"bind matrix Z statistics created getzs rowRanges SummarizedExperiment","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/bind_Zs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"bind a matrix of Z statistics created with getzs to the rowRanges of a SummarizedExperiment — bind_Zs","text":"","code":"bind_Zs(se, colselector = function(se) 1:10)"},{"path":"https://github.com/vjcitn/biocXqtl/reference/bind_Zs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"bind a matrix of Z statistics created with getzs to the rowRanges of a SummarizedExperiment — bind_Zs","text":"se SummarizedExperiment assumed molecular phenotype data assay colselector function argument \"se\" returning indices SNP genotypes colData(se)","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/bind_Zs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"bind a matrix of Z statistics created with getzs to the rowRanges of a SummarizedExperiment — bind_Zs","text":"","code":"data(geuv19) lk = geuv19[1:20,] mafs = maf(colData(lk)) # only snps here colData(lk) = colData(lk)[,which(mafs>.25)] lk = bind_Zs(lk) head(rowRanges(lk)[,7]) #> GRanges object with 6 ranges and 1 metadata column: #>                   seqnames            ranges strand | snp_19_1400679 #>                      <Rle>         <IRanges>  <Rle> |      <numeric> #>   ENST00000545779       18 15254418-15271744      + |      0.0361026 #>   ENST00000408051       19       71973-72110      + |            NaN #>   ENST00000318050       19     110643-111696      + |      1.1910512 #>   ENST00000410397       19     223158-223261      - |            NaN #>   ENST00000327790       19     281040-291185      - |      1.0622605 #>   ENST00000434325       19     281040-291504      - |      0.2106134 #>   ------- #>   seqinfo: 319 sequences (1 circular) from GRCh38 genome plpp2tx = as.numeric(assay(lk[\"ENST00000434325\",])) hiz = colData(lk)[,\"snp_19_5694231\"] plot(plpp2tx~jitter(hiz), xlab=\"snp at 19:5694231\", ylab=\"counts for a transcript of PLPP2\")  summary(lm(plpp2tx~hiz)) #>  #> Call: #> lm(formula = plpp2tx ~ hiz) #>  #> Residuals: #>    Min     1Q Median     3Q    Max  #> -9.636 -5.245 -0.854 -0.854 52.868  #>  #> Coefficients: #>             Estimate Std. Error t value Pr(>|t|)    #> (Intercept)   0.8542     1.1717   0.729  0.46790    #> hiz           4.3908     1.4936   2.940  0.00418 ** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> Residual standard error: 8.547 on 89 degrees of freedom #> Multiple R-squared:  0.08851,\tAdjusted R-squared:  0.07827  #> F-statistic: 8.642 on 1 and 89 DF,  p-value: 0.004184 #>"},{"path":"https://github.com/vjcitn/biocXqtl/reference/getzs.html","id":null,"dir":"Reference","previous_headings":"","what":"create a matrix of Z statistics for an additive effect of rare allele count in calls on molecular phenotype in molec — getzs","title":"create a matrix of Z statistics for an additive effect of rare allele count in calls on molecular phenotype in molec — getzs","text":"create matrix Z statistics additive effect rare allele count calls molecular phenotype molec","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/getzs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"create a matrix of Z statistics for an additive effect of rare allele count in calls on molecular phenotype in molec — getzs","text":"","code":"getzs(molec, calls)"},{"path":"https://github.com/vjcitn/biocXqtl/reference/getzs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"create a matrix of Z statistics for an additive effect of rare allele count in calls on molecular phenotype in molec — getzs","text":"molec numeric matrix molecular phenotype values, columns samples calls numeric matrix rare allele counts, rows samples, columns loci","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/getzs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"create a matrix of Z statistics for an additive effect of rare allele count in calls on molecular phenotype in molec — getzs","text":"matrix one row per","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/getzs.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"create a matrix of Z statistics for an additive effect of rare allele count in calls on molecular phenotype in molec — getzs","text":"SNP MAF 0, NA returned.","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/getzs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"create a matrix of Z statistics for an additive effect of rare allele count in calls on molecular phenotype in molec — getzs","text":"","code":"data(geuv19) mol = assay(geuv19) calls = data.matrix(as.data.frame(colData(geuv19))) m = maf(calls) allz = getzs(mol[1:100,], calls[,m>.3]) summary(as.numeric(allz)) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #> -4.4767 -0.5831  0.1399  0.1047  0.7790  4.3300    1988"},{"path":"https://github.com/vjcitn/biocXqtl/reference/geuv19.html","id":null,"dir":"Reference","previous_headings":"","what":"a RangedSummarizedExperiment with data from GeuvadisTranscriptExpr — geuv19","title":"a RangedSummarizedExperiment with data from GeuvadisTranscriptExpr — geuv19","text":"RangedSummarizedExperiment data GeuvadisTranscriptExpr","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/geuv19.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"a RangedSummarizedExperiment with data from GeuvadisTranscriptExpr — geuv19","text":"","code":"geuv19"},{"path":"https://github.com/vjcitn/biocXqtl/reference/geuv19.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"a RangedSummarizedExperiment with data from GeuvadisTranscriptExpr — geuv19","text":"RangedSummarizedExperiment","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/geuv19.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"a RangedSummarizedExperiment with data from GeuvadisTranscriptExpr — geuv19","text":"Minor allele counts colData.  entries -1.  explained GeuvadisTranscriptExpr.","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/geuv19.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"a RangedSummarizedExperiment with data from GeuvadisTranscriptExpr — geuv19","text":"","code":"data(geuv19) rowRanges(geuv19[1:3,]) #> GRanges object with 3 ranges and 6 metadata columns: #>                   seqnames            ranges strand |           tx_id #>                      <Rle>         <IRanges>  <Rle> |     <character> #>   ENST00000545779       18 15254418-15271744      + | ENST00000545779 #>   ENST00000408051       19       71973-72110      + | ENST00000408051 #>   ENST00000318050       19     110643-111696      + | ENST00000318050 #>                               tx_biotype tx_cds_seq_start tx_cds_seq_end #>                              <character>        <integer>      <integer> #>   ENST00000545779 unprocessed_pseudogene             <NA>           <NA> #>   ENST00000408051                  miRNA             <NA>           <NA> #>   ENST00000318050         protein_coding           110679         111596 #>                           gene_id         tx_name #>                       <character>     <character> #>   ENST00000545779 ENSG00000266818 ENST00000545779 #>   ENST00000408051 ENSG00000275604 ENST00000408051 #>   ENST00000318050 ENSG00000176695 ENST00000318050 #>   ------- #>   seqinfo: 319 sequences (1 circular) from GRCh38 genome"},{"path":"https://github.com/vjcitn/biocXqtl/reference/maf.html","id":null,"dir":"Reference","previous_headings":"","what":"simple function for MAF calculation — maf","title":"simple function for MAF calculation — maf","text":"simple function MAF calculation","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/maf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simple function for MAF calculation — maf","text":"","code":"maf(snpmat)"},{"path":"https://github.com/vjcitn/biocXqtl/reference/maf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simple function for MAF calculation — maf","text":"snpmat entity answers `apply(...,2,f)` columns corresponding SNPs, rows corresponding minor allele count individuals","code":""},{"path":"https://github.com/vjcitn/biocXqtl/reference/maf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simple function for MAF calculation — maf","text":"","code":"data(\"geuv19\", package=\"biocXqtl\") m = maf(colData(geuv19)) summary(m) #>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  #> -0.07143  0.00000  0.04945  0.14139  0.18132  1.00000"}]
