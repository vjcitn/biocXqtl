<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>biocXqtl: flexible molecular QTL assessment â€¢ biocXqtl</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="biocXqtl: flexible molecular QTL assessment">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">biocXqtl</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/biocXqtl.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/vjcitn/biocXqtl/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>biocXqtl: flexible molecular QTL assessment</h1>
                        <h4 data-toc-skip class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">December 16, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/biocXqtl/blob/HEAD/vignettes/biocXqtl.Rmd"><code>vignettes/biocXqtl.Rmd</code></a></small>
      <div class="d-none name"><code>biocXqtl.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>eQTL analysis generally involves large data volumes of genotype calls. No standard representation for genotypes has emerged, though VCFs and plink2 files are frequently encountered.</p>
<p>In this package we provide a flexible approach to estimating associations between genotype and molecular phenotypes such as gene expression or DNA methylation. We will use the RangedSummarizedExperiment structure as the primary element for structuring the inputs to association test procedures.</p>
</div>
<div class="section level2">
<h2 id="preliminary-illustration">Preliminary illustration<a class="anchor" aria-label="anchor" href="#preliminary-illustration"></a>
</h2>
<p><code>geuv19</code> is a RangedSummarizedExperiment derived from the <a href="https://bioconductor.org/package/GeuvadisTranscriptExpr" class="external-link">GeuvadisTranscriptExpr</a> package. The assay component provides transcript level counts. Genotypes are available in the colData.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn" class="external-link">biocXqtl</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">geuv19</span><span class="op">)</span></span>
<span><span class="va">geuv19</span></span></code></pre></div>
<pre><code><span><span class="co">## class: RangedSummarizedExperiment </span></span>
<span><span class="co">## dim: 4278 91 </span></span>
<span><span class="co">## metadata(1): snplocs</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames(4278): ENST00000545779 ENST00000408051 ... ENST00000313038</span></span>
<span><span class="co">##   ENST00000401283</span></span>
<span><span class="co">## rowData names(6): tx_id tx_biotype ... gene_id tx_name</span></span>
<span><span class="co">## colnames(91): NA06984 NA06985 ... NA12889 NA12890</span></span>
<span><span class="co">## colData names(1330): snp_19_1392636 snp_19_1393723 ... snp_19_58273441</span></span>
<span><span class="co">##   snp_19_58274425</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">geuv19</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    NA06984 NA06985 NA06986 NA06989</span></span>
<span><span class="co">## ENST00000545779 180.000000      40      58     172</span></span>
<span><span class="co">## ENST00000408051   0.000000       0       0       0</span></span>
<span><span class="co">## ENST00000318050   0.805323       0       0       0</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rowRanges</span><span class="op">(</span><span class="va">geuv19</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 3 ranges and 6 metadata columns:</span></span>
<span><span class="co">##                   seqnames            ranges strand |           tx_id</span></span>
<span><span class="co">##                      &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; |     &lt;character&gt;</span></span>
<span><span class="co">##   ENST00000545779       18 15254418-15271744      + | ENST00000545779</span></span>
<span><span class="co">##   ENST00000408051       19       71973-72110      + | ENST00000408051</span></span>
<span><span class="co">##   ENST00000318050       19     110643-111696      + | ENST00000318050</span></span>
<span><span class="co">##                               tx_biotype tx_cds_seq_start tx_cds_seq_end</span></span>
<span><span class="co">##                              &lt;character&gt;        &lt;integer&gt;      &lt;integer&gt;</span></span>
<span><span class="co">##   ENST00000545779 unprocessed_pseudogene             &lt;NA&gt;           &lt;NA&gt;</span></span>
<span><span class="co">##   ENST00000408051                  miRNA             &lt;NA&gt;           &lt;NA&gt;</span></span>
<span><span class="co">##   ENST00000318050         protein_coding           110679         111596</span></span>
<span><span class="co">##                           gene_id         tx_name</span></span>
<span><span class="co">##                       &lt;character&gt;     &lt;character&gt;</span></span>
<span><span class="co">##   ENST00000545779 ENSG00000266818 ENST00000545779</span></span>
<span><span class="co">##   ENST00000408051 ENSG00000275604 ENST00000408051</span></span>
<span><span class="co">##   ENST00000318050 ENSG00000176695 ENST00000318050</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 319 sequences (1 circular) from GRCh38 genome</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">geuv19</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 3 rows and 4 columns</span></span>
<span><span class="co">##         snp_19_1392636 snp_19_1393723 snp_19_1394530 snp_19_1396952</span></span>
<span><span class="co">##              &lt;integer&gt;      &lt;integer&gt;      &lt;integer&gt;      &lt;integer&gt;</span></span>
<span><span class="co">## NA06984              1              0              0              0</span></span>
<span><span class="co">## NA06985              0              0              0              0</span></span>
<span><span class="co">## NA06986              0              0              0              0</span></span></code></pre>
<p>From a computational viewpoint, the simplest assessment of molecular QTLs involves fitting a linear model to assess additive association of minor allele dose with the molecular response. From an organizational viewpoint, a simple approach is to start and end with a RangedSummarizedExperiment instance. <code>bind_Zs</code> carries this out for the situation in which genotype calls are managed in a natural way in colData.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/maf.html">maf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">geuv19</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ok</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">m</span> <span class="op">&gt;</span> <span class="fl">.3</span><span class="op">)</span></span>
<span><span class="va">limg</span> <span class="op">=</span> <span class="va">geuv19</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">limg</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">limg</span><span class="op">)</span><span class="op">[</span>,<span class="va">ok</span><span class="op">]</span></span>
<span><span class="va">limg</span> <span class="op">=</span> <span class="fu"><a href="../reference/bind_Zs.html">bind_Zs</a></span><span class="op">(</span><span class="va">limg</span>, </span>
<span>   colselector<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">limg</span></span></code></pre></div>
<pre><code><span><span class="co">## class: RangedSummarizedExperiment </span></span>
<span><span class="co">## dim: 100 91 </span></span>
<span><span class="co">## metadata(1): snplocs</span></span>
<span><span class="co">## assays(1): counts</span></span>
<span><span class="co">## rownames(100): ENST00000545779 ENST00000408051 ... ENST00000313093</span></span>
<span><span class="co">##   ENST00000543365</span></span>
<span><span class="co">## rowData names(243): tx_id tx_biotype ... snp_19_58269173</span></span>
<span><span class="co">##   snp_19_58274425</span></span>
<span><span class="co">## colnames(91): NA06984 NA06985 ... NA12889 NA12890</span></span>
<span><span class="co">## colData names(237): snp_19_1400679 snp_19_1400766 ... snp_19_58269173</span></span>
<span><span class="co">##   snp_19_58274425</span></span></code></pre>
<p>All the Z-scores for tests of association are in the rowRanges of <code>limg</code>. The first 6 elements of the mcols of the rowRanges are related to annotation. A heatmap of the Z-scores shows a band of transcripts with all zero counts. Very light tiles correspond to negative Z-scores, dark tiles to positive.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">mcols</span><span class="op">(</span><span class="fu">rowRanges</span><span class="op">(</span><span class="va">limg</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">zs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">zs</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">zs</span>, Colv<span class="op">=</span><span class="cn">NA</span>, scale<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="biocXqtl_files/figure-html/lklll-1.png" class="r-plt" width="700"></p>
<p>With some helper functions, the basic data layout can be seen, illustrating inappropriateness standard linear modeling assumptions underlying interpretation of the Z-score.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mo</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">limg</span><span class="op">[</span><span class="va">x</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sn</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">limg</span><span class="op">)</span><span class="op">[</span>,<span class="va">x</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">beeswarm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/beeswarm/man/beeswarm.html" class="external-link">beeswarm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="fu">mo</span><span class="op">(</span><span class="st">"ENST00000529442"</span><span class="op">)</span><span class="op">)</span><span class="op">~</span><span class="fu">sn</span><span class="op">(</span><span class="st">"snp_19_19631444"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="biocXqtl_files/figure-html/lkda-1.png" class="r-plt" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
